{"version":3,"file":"shtcut-provider.js","names":["_utils","require","_react","_defaultTheme","_utils2","_lodash","_interopRequireDefault","_toCssVar","_react2","obj","__esModule","_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","ShtcutContext","exports","createContext","undefined","displayName","ShtcutProvider","_ref","_ref$theme","theme","defaultTheme","_ref$colorScheme","colorScheme","_ref$density","density","_ref$cssVarsRoot","cssVarsRoot","children","computedTheme","useMemo","_theme$colorSchemes$c","omittedTheme","omit","_ref2","colorSchemes","colors","type","isBrowser","document","documentElement","classList","add","remove","walkObject","value","path","isString","rgb","toRGB","set","join","normalizedTheme","toCSSVar","React","createElement","Provider","Global","styles","_ref3","__cssVars","useShtcut","useContext","Error","extendTheme","themeOverride","deepMerge","clone"],"sources":["../../src/shtcut-provider.tsx"],"sourcesContent":["import { Dict, WithCSSVar, deepMerge, isString, omit, toRGB, walkObject } from '@shtcut-ui/utils';\nimport { Context, ReactNode, createContext, useContext, useMemo } from 'react';\nimport { ShtcutThemeOverride, ShtcutUiTheme } from './types';\nimport { defaultTheme } from './default-theme';\nimport { isBrowser } from './utils';\nimport set from 'lodash.set';\nimport { toCSSVar } from './to-css-var';\nimport { Global } from '@emotion/react';\n\ninterface DictShtcutTheme extends Dict {}\n\nexport const ShtcutContext = createContext<{ theme: WithCSSVar<DictShtcutTheme> } | undefined>(undefined);\n\nShtcutContext.displayName = 'ShtcutContext';\n\nexport interface ShtcutProviderProps {\n  children: ReactNode;\n  theme?: ShtcutUiTheme;\n  density?: 'compact' | 'comfortable' | 'unset';\n  colorScheme?: string;\n  cssVarsRoot?: string;\n}\n\nexport function ShtcutProvider({\n  theme = defaultTheme,\n  colorScheme = 'light',\n  density = 'comfortable',\n  cssVarsRoot = ':host, :root',\n  children,\n}: ShtcutProviderProps) {\n  const computedTheme = useMemo(() => {\n    const omittedTheme = omit(theme, ['colorSchemes', 'density']);\n    const { colors, type } = theme.colorSchemes[colorScheme] ?? {};\n    if (isBrowser) {\n      if (type === 'dark') document.documentElement.classList.add('dark');\n      else document.documentElement.classList.remove('dark');\n    }\n    walkObject(colors, (value, path) => {\n      if (!isString(value)) return;\n      const rgb = toRGB(value);\n      if (rgb) set(colors, path, rgb.join(','));\n    });\n    const normalizedTheme = {\n      ...omittedTheme,\n      density: theme.density[density],\n      colors,\n    };\n    return toCSSVar(normalizedTheme);\n  }, [theme, colorScheme, density]);\n\n  const value = useMemo(\n    () => ({\n      theme: computedTheme,\n    }),\n    [computedTheme],\n  );\n  return (\n    <ShtcutContext.Provider value={value}>\n      <Global styles={() => ({ [cssVarsRoot]: computedTheme.__cssVars })} />\n      {children}\n    </ShtcutContext.Provider>\n  );\n}\n\nexport function useShtcut<T extends object = Dict>() {\n  const theme = useContext(ShtcutContext as unknown as Context<T | undefined>);\n  if (!theme) {\n    throw Error('useShtcut: `theme` is defined. Maybe you have not to wrap your app in <ShtcutProvider />');\n  }\n  return theme as WithCSSVar<T>;\n}\n\nexport function extendTheme(themeOverride: ShtcutThemeOverride): ShtcutUiTheme {\n  return deepMerge(defaultTheme, themeOverride, { clone: true }) as ShtcutUiTheme;\n}\n"],"mappings":";;;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AAEA,IAAAE,aAAA,GAAAF,OAAA;AACA,IAAAG,OAAA,GAAAH,OAAA;AACA,IAAAI,OAAA,GAAAC,sBAAA,CAAAL,OAAA;AACA,IAAAM,SAAA,GAAAN,OAAA;AACA,IAAAO,OAAA,GAAAP,OAAA;AAAwC,SAAAK,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,gBAAAA,GAAA;AAAA,SAAAE,SAAA,IAAAA,QAAA,GAAAC,MAAA,CAAAC,MAAA,GAAAD,MAAA,CAAAC,MAAA,CAAAC,IAAA,eAAAC,MAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAF,CAAA,UAAAG,MAAA,GAAAF,SAAA,CAAAD,CAAA,YAAAI,GAAA,IAAAD,MAAA,QAAAP,MAAA,CAAAS,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAJ,MAAA,EAAAC,GAAA,KAAAL,MAAA,CAAAK,GAAA,IAAAD,MAAA,CAAAC,GAAA,gBAAAL,MAAA,YAAAJ,QAAA,CAAAa,KAAA,OAAAP,SAAA;AAIjC,IAAMQ,aAAa,GAAAC,OAAA,CAAAD,aAAA,gBAAG,IAAAE,oBAAa,EAAqDC,SAAS,CAAC;AAEzGH,aAAa,CAACI,WAAW,GAAG,eAAe;AAUpC,SAASC,cAAcA,CAAAC,IAAA,EAMN;EAAA,IAAAC,UAAA,GAAAD,IAAA,CALtBE,KAAK;IAALA,KAAK,GAAAD,UAAA,cAAGE,0BAAY,GAAAF,UAAA;IAAAG,gBAAA,GAAAJ,IAAA,CACpBK,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAG,OAAO,GAAAA,gBAAA;IAAAE,YAAA,GAAAN,IAAA,CACrBO,OAAO;IAAPA,OAAO,GAAAD,YAAA,cAAG,aAAa,GAAAA,YAAA;IAAAE,gBAAA,GAAAR,IAAA,CACvBS,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAG,cAAc,GAAAA,gBAAA;IAC5BE,QAAQ,GAAAV,IAAA,CAARU,QAAQ;EAER,IAAMC,aAAa,GAAG,IAAAC,cAAO,EAAC,YAAM;IAAA,IAAAC,qBAAA;IAClC,IAAMC,YAAY,GAAG,IAAAC,WAAI,EAACb,KAAK,EAAE,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;IAC7D,IAAAc,KAAA,IAAAH,qBAAA,GAAyBX,KAAK,CAACe,YAAY,CAACZ,WAAW,CAAC,YAAAQ,qBAAA,GAAI,CAAC,CAAC;MAAtDK,MAAM,GAAAF,KAAA,CAANE,MAAM;MAAEC,IAAI,GAAAH,KAAA,CAAJG,IAAI;IACpB,IAAIC,iBAAS,EAAE;MACb,IAAID,IAAI,KAAK,MAAM,EAAEE,QAAQ,CAACC,eAAe,CAACC,SAAS,CAACC,GAAG,CAAC,MAAM,CAAC,CAAC,KAC/DH,QAAQ,CAACC,eAAe,CAACC,SAAS,CAACE,MAAM,CAAC,MAAM,CAAC;IACxD;IACA,IAAAC,iBAAU,EAACR,MAAM,EAAE,UAACS,KAAK,EAAEC,IAAI,EAAK;MAClC,IAAI,CAAC,IAAAC,eAAQ,EAACF,KAAK,CAAC,EAAE;MACtB,IAAMG,GAAG,GAAG,IAAAC,YAAK,EAACJ,KAAK,CAAC;MACxB,IAAIG,GAAG,EAAE,IAAAE,kBAAG,EAACd,MAAM,EAAEU,IAAI,EAAEE,GAAG,CAACG,IAAI,CAAC,GAAG,CAAC,CAAC;IAC3C,CAAC,CAAC;IACF,IAAMC,eAAe,GAAAtD,QAAA,KAChBkC,YAAY;MACfP,OAAO,EAAEL,KAAK,CAACK,OAAO,CAACA,OAAO,CAAC;MAC/BW,MAAM,EAANA;IAAM,EACP;IACD,OAAO,IAAAiB,kBAAQ,EAACD,eAAe,CAAC;EAClC,CAAC,EAAE,CAAChC,KAAK,EAAEG,WAAW,EAAEE,OAAO,CAAC,CAAC;EAEjC,IAAMoB,KAAK,GAAG,IAAAf,cAAO,EACnB;IAAA,OAAO;MACLV,KAAK,EAAES;IACT,CAAC;EAAA,CAAC,EACF,CAACA,aAAa,CAChB,CAAC;EACD,oBACEyB,KAAA,CAAAC,aAAA,CAAC3C,aAAa,CAAC4C,QAAQ;IAACX,KAAK,EAAEA;EAAM,gBACnCS,KAAA,CAAAC,aAAA,CAAC5D,OAAA,CAAA8D,MAAM;IAACC,MAAM,EAAE,SAAAA,OAAA;MAAA,IAAAC,KAAA;MAAA,OAAAA,KAAA,OAAAA,KAAA,CAAUhC,WAAW,IAAGE,aAAa,CAAC+B,SAAS,EAAAD,KAAA;IAAA;EAAI,CAAE,CAAC,EACrE/B,QACqB,CAAC;AAE7B;AAEO,SAASiC,SAASA,CAAA,EAA4B;EACnD,IAAMzC,KAAK,GAAG,IAAA0C,iBAAU,EAAClD,aAAkD,CAAC;EAC5E,IAAI,CAACQ,KAAK,EAAE;IACV,MAAM2C,KAAK,CAAC,0FAA0F,CAAC;EACzG;EACA,OAAO3C,KAAK;AACd;AAEO,SAAS4C,WAAWA,CAACC,aAAkC,EAAiB;EAC7E,OAAO,IAAAC,gBAAS,EAAC7C,0BAAY,EAAE4C,aAAa,EAAE;IAAEE,KAAK,EAAE;EAAK,CAAC,CAAC;AAChE"}